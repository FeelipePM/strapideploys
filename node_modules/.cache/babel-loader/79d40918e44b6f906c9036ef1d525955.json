{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = require(\"react\");\n\nvar _helperPlugin = require(\"@strapi/helper-plugin\");\n\nvar _utils = require(\"../../utils\");\n\nvar _reducer = _interopRequireWildcard(require(\"./reducer\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nvar useUserForm = function useUserForm(endPoint, permissions) {\n  var _useRBAC = (0, _helperPlugin.useRBAC)(permissions),\n      isLoadingForPermissions = _useRBAC.isLoading,\n      allowedActions = _useRBAC.allowedActions;\n\n  var _useReducer = (0, _react.useReducer)(_reducer[\"default\"], _reducer.initialState),\n      _useReducer2 = (0, _slicedToArray2[\"default\"])(_useReducer, 2),\n      _useReducer2$ = _useReducer2[0],\n      isLoading = _useReducer2$.isLoading,\n      modifiedData = _useReducer2$.modifiedData,\n      dispatch = _useReducer2[1];\n\n  var toggleNotification = (0, _helperPlugin.useNotification)();\n  var isMounted = (0, _react.useRef)(true);\n  var abortController = new AbortController();\n  var signal = abortController.signal;\n  (0, _react.useEffect)(function () {\n    var getData = /*#__PURE__*/function () {\n      var _ref = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee() {\n        var data;\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                dispatch({\n                  type: 'GET_DATA'\n                });\n                _context.next = 4;\n                return (0, _helperPlugin.request)((0, _utils.getRequestURL)(endPoint), {\n                  method: 'GET',\n                  signal: signal\n                });\n\n              case 4:\n                data = _context.sent;\n                dispatch({\n                  type: 'GET_DATA_SUCCEEDED',\n                  data: data\n                });\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n\n                // The user aborted the request\n                if (isMounted.current) {\n                  dispatch({\n                    type: 'GET_DATA_ERROR'\n                  });\n                  console.error(_context.t0);\n                  toggleNotification({\n                    type: 'warning',\n                    message: {\n                      id: 'notification.error'\n                    }\n                  });\n                }\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n\n      return function getData() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    if (!isLoadingForPermissions) {\n      getData();\n    }\n\n    return function () {\n      abortController.abort();\n      isMounted.current = false;\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isLoadingForPermissions, endPoint]);\n  var dispatchSubmitSucceeded = (0, _react.useCallback)(function (data) {\n    dispatch({\n      type: 'ON_SUBMIT_SUCCEEDED',\n      data: data\n    });\n  }, []);\n  return {\n    allowedActions: allowedActions,\n    dispatchSubmitSucceeded: dispatchSubmitSucceeded,\n    isLoading: isLoading,\n    isLoadingForPermissions: isLoadingForPermissions,\n    modifiedData: modifiedData\n  };\n};\n\nvar _default = useUserForm;\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}