{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _Select = require(\"@strapi/design-system/Select\");\n\nvar _useDataManager2 = _interopRequireDefault(require(\"../../hooks/useDataManager\"));\n\n/**\n *\n * SelectComponent\n *\n */\nvar SelectComponent = function SelectComponent(_ref) {\n  var error = _ref.error,\n      intlLabel = _ref.intlLabel,\n      isAddingAComponentToAnotherComponent = _ref.isAddingAComponentToAnotherComponent,\n      isCreating = _ref.isCreating,\n      isCreatingComponentWhileAddingAField = _ref.isCreatingComponentWhileAddingAField,\n      componentToCreate = _ref.componentToCreate,\n      name = _ref.name,\n      _onChange = _ref.onChange,\n      targetUid = _ref.targetUid,\n      forTarget = _ref.forTarget,\n      value = _ref.value;\n\n  var _useIntl = (0, _reactIntl.useIntl)(),\n      formatMessage = _useIntl.formatMessage;\n\n  var errorMessage = error ? formatMessage({\n    id: error,\n    defaultMessage: error\n  }) : '';\n  var label = formatMessage(intlLabel);\n\n  var _useDataManager = (0, _useDataManager2[\"default\"])(),\n      componentsGroupedByCategory = _useDataManager.componentsGroupedByCategory,\n      componentsThatHaveOtherComponentInTheirAttributes = _useDataManager.componentsThatHaveOtherComponentInTheirAttributes;\n\n  var isTargetAComponent = ['component', 'components'].includes(forTarget);\n  var options = Object.entries(componentsGroupedByCategory).reduce(function (acc, current) {\n    var _current = (0, _slicedToArray2[\"default\"])(current, 2),\n        categoryName = _current[0],\n        components = _current[1];\n\n    var compos = components.map(function (component) {\n      return {\n        uid: component.uid,\n        label: component.schema.displayName,\n        categoryName: categoryName\n      };\n    });\n    return [].concat((0, _toConsumableArray2[\"default\"])(acc), (0, _toConsumableArray2[\"default\"])(compos));\n  }, []);\n\n  if (isAddingAComponentToAnotherComponent) {\n    options = options.filter(function (option) {\n      return !componentsThatHaveOtherComponentInTheirAttributes.includes(option.uid);\n    });\n  }\n\n  if (isTargetAComponent) {\n    options = options.filter(function (option) {\n      return option.uid !== targetUid;\n    });\n  }\n\n  if (isCreatingComponentWhileAddingAField) {\n    options = [{\n      uid: value,\n      label: componentToCreate.displayName,\n      categoryName: componentToCreate.category\n    }];\n  }\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_Select.Select, {\n    disabled: isCreatingComponentWhileAddingAField || !isCreating,\n    error: errorMessage,\n    label: label,\n    id: name,\n    name: name,\n    onChange: function onChange(value) {\n      _onChange({\n        target: {\n          name: name,\n          value: value,\n          type: 'select-category'\n        }\n      });\n    },\n    value: value || ''\n  }, options.map(function (option) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_Select.Option, {\n      key: option.uid,\n      value: option.uid\n    }, \"\".concat(option.categoryName, \" - \").concat(option.label));\n  }));\n};\n\nSelectComponent.defaultProps = {\n  componentToCreate: null,\n  error: null\n};\nSelectComponent.propTypes = {\n  componentToCreate: _propTypes[\"default\"].object,\n  forTarget: _propTypes[\"default\"].string.isRequired,\n  error: _propTypes[\"default\"].string,\n  intlLabel: _propTypes[\"default\"].shape({\n    id: _propTypes[\"default\"].string.isRequired,\n    defaultMessage: _propTypes[\"default\"].string.isRequired,\n    values: _propTypes[\"default\"].object\n  }).isRequired,\n  isAddingAComponentToAnotherComponent: _propTypes[\"default\"].bool.isRequired,\n  isCreating: _propTypes[\"default\"].bool.isRequired,\n  isCreatingComponentWhileAddingAField: _propTypes[\"default\"].bool.isRequired,\n  name: _propTypes[\"default\"].string.isRequired,\n  onChange: _propTypes[\"default\"].func.isRequired,\n  targetUid: _propTypes[\"default\"].string.isRequired,\n  value: _propTypes[\"default\"].string.isRequired\n};\nvar _default = SelectComponent;\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}