{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _Grid = require(\"@strapi/design-system/Grid\");\n\nvar _Box = require(\"@strapi/design-system/Box\");\n\nvar _Checkbox = require(\"@strapi/design-system/Checkbox\");\n\nvar _Flex = require(\"@strapi/design-system/Flex\");\n\nvar _Typography = require(\"@strapi/design-system/Typography\");\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _get = _interopRequireDefault(require(\"lodash/get\"));\n\nvar _hooks = require(\"../../../../../../../../hooks\");\n\nvar _utils = require(\"../../utils\");\n\nvar _ConditionsButton = _interopRequireDefault(require(\"../../ConditionsButton\"));\n\nvar _ConditionsModal = _interopRequireDefault(require(\"../../ConditionsModal\"));\n\nvar _utils2 = require(\"./utils\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nvar IS_DISABLED = function () {\n  if (window && window.strapi && window.strapi.isEE) {\n    return require('../../../../../../../../../../ee/admin/pages/SettingsPage/pages/Roles/EditPage/components/PluginsAndSettings/SubCategory/utils/constants')[\"default\"];\n  }\n\n  return require('./utils/constants')[\"default\"];\n}();\n\nvar Border = /*#__PURE__*/_styledComponents[\"default\"].div.withConfig({\n  displayName: \"SubCategory__Border\",\n  componentId: \"sc-akgczm-0\"\n})([\"flex:1;align-self:center;border-top:1px solid \", \";\"], function (_ref) {\n  var theme = _ref.theme;\n  return theme.colors.neutral150;\n});\n\nvar CheckboxWrapper = /*#__PURE__*/_styledComponents[\"default\"].div.withConfig({\n  displayName: \"SubCategory__CheckboxWrapper\",\n  componentId: \"sc-akgczm-1\"\n})([\"position:relative;word-break:keep-all;\", \"\"], function (_ref2) {\n  var hasConditions = _ref2.hasConditions,\n      disabled = _ref2.disabled,\n      theme = _ref2.theme;\n  return hasConditions && \"\\n    &:before {\\n      content: '';\\n      position: absolute;\\n      top: \".concat(-4 / 16, \"rem;\\n      left: \").concat(-8 / 16, \"rem;\\n      width: \").concat(6 / 16, \"rem;\\n      height: \").concat(6 / 16, \"rem;\\n      border-radius: \").concat(20 / 16, \"rem;\\n      background: \").concat(disabled ? theme.colors.neutral100 : theme.colors.primary600, \";\\n    }\\n  \");\n});\n\nvar SubCategory = function SubCategory(_ref3) {\n  var categoryName = _ref3.categoryName,\n      isFormDisabled = _ref3.isFormDisabled,\n      subCategoryName = _ref3.subCategoryName,\n      actions = _ref3.actions,\n      pathToData = _ref3.pathToData;\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      isModalOpen = _useState2[0],\n      setModalOpen = _useState2[1];\n\n  var _usePermissionsDataMa = (0, _hooks.usePermissionsDataManager)(),\n      modifiedData = _usePermissionsDataMa.modifiedData,\n      onChangeParentCheckbox = _usePermissionsDataMa.onChangeParentCheckbox,\n      onChangeSimpleCheckbox = _usePermissionsDataMa.onChangeSimpleCheckbox;\n\n  var _useIntl = (0, _reactIntl.useIntl)(),\n      formatMessage = _useIntl.formatMessage;\n\n  var mainData = (0, _get[\"default\"])(modifiedData, pathToData, {});\n  var dataWithoutCondition = (0, _react.useMemo)(function () {\n    return Object.keys(mainData).reduce(function (acc, current) {\n      acc[current] = (0, _utils.removeConditionKeyFromData)(mainData[current]);\n      return acc;\n    }, {});\n  }, [mainData]);\n\n  var _getCheckboxState = (0, _utils.getCheckboxState)(dataWithoutCondition),\n      hasAllActionsSelected = _getCheckboxState.hasAllActionsSelected,\n      hasSomeActionsSelected = _getCheckboxState.hasSomeActionsSelected;\n\n  var handleToggleModalIsOpen = function handleToggleModalIsOpen() {\n    setModalOpen(function (s) {\n      return !s;\n    });\n  };\n\n  var handleModalClose = function handleModalClose() {\n    setModalOpen(false);\n  }; // We need to format the actions so it matches the shape of the ConditionsModal actions props\n\n\n  var formattedActions = (0, _utils2.formatActions)(actions, modifiedData, pathToData);\n  var doesButtonHasCondition = (0, _utils2.getConditionsButtonState)((0, _get[\"default\"])(modifiedData, (0, _toConsumableArray2[\"default\"])(pathToData), {}));\n  return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_Box.Box, null, /*#__PURE__*/_react[\"default\"].createElement(_Flex.Flex, {\n    justifyContent: \"space-between\",\n    alignItems: \"center\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Box.Box, {\n    paddingRight: 4\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Typography.Typography, {\n    variant: \"sigma\",\n    textColor: \"neutral600\"\n  }, subCategoryName)), /*#__PURE__*/_react[\"default\"].createElement(Border, null), /*#__PURE__*/_react[\"default\"].createElement(_Box.Box, {\n    paddingLeft: 4\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Checkbox.Checkbox, {\n    name: pathToData.join('..'),\n    disabled: isFormDisabled || IS_DISABLED // Keep same signature as packages/core/admin/admin/src/components/Roles/Permissions/index.js l.91\n    ,\n    onValueChange: function onValueChange(value) {\n      onChangeParentCheckbox({\n        target: {\n          name: pathToData.join('..'),\n          value: value\n        }\n      });\n    },\n    indeterminate: hasSomeActionsSelected,\n    value: hasAllActionsSelected\n  }, formatMessage({\n    id: 'app.utils.select-all',\n    defaultMessage: 'Select all'\n  })))), /*#__PURE__*/_react[\"default\"].createElement(_Flex.Flex, {\n    paddingTop: 6,\n    paddingBottom: 6\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Grid.Grid, {\n    gap: 2,\n    style: {\n      flex: 1\n    }\n  }, formattedActions.map(function (_ref4) {\n    var checkboxName = _ref4.checkboxName,\n        value = _ref4.value,\n        action = _ref4.action,\n        displayName = _ref4.displayName,\n        hasConditions = _ref4.hasConditions;\n    return /*#__PURE__*/_react[\"default\"].createElement(_Grid.GridItem, {\n      col: 3,\n      key: action\n    }, /*#__PURE__*/_react[\"default\"].createElement(CheckboxWrapper, {\n      disabled: isFormDisabled || IS_DISABLED,\n      hasConditions: hasConditions\n    }, /*#__PURE__*/_react[\"default\"].createElement(_Checkbox.Checkbox, {\n      name: checkboxName,\n      disabled: isFormDisabled || IS_DISABLED // Keep same signature as packages/core/admin/admin/src/components/Roles/Permissions/index.js l.91\n      ,\n      onValueChange: function onValueChange(value) {\n        onChangeSimpleCheckbox({\n          target: {\n            name: checkboxName,\n            value: value\n          }\n        });\n      },\n      value: value\n    }, displayName)));\n  })), /*#__PURE__*/_react[\"default\"].createElement(_ConditionsButton[\"default\"], {\n    hasConditions: doesButtonHasCondition,\n    onClick: handleToggleModalIsOpen\n  }))), isModalOpen && /*#__PURE__*/_react[\"default\"].createElement(_ConditionsModal[\"default\"], {\n    headerBreadCrumbs: [categoryName, subCategoryName],\n    actions: formattedActions,\n    isFormDisabled: isFormDisabled,\n    onClosed: handleModalClose,\n    onToggle: handleToggleModalIsOpen\n  }));\n};\n\nSubCategory.propTypes = {\n  actions: _propTypes[\"default\"].array.isRequired,\n  categoryName: _propTypes[\"default\"].string.isRequired,\n  isFormDisabled: _propTypes[\"default\"].bool.isRequired,\n  subCategoryName: _propTypes[\"default\"].string.isRequired,\n  pathToData: _propTypes[\"default\"].array.isRequired\n};\nvar _default = SubCategory;\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}