{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactDnd = require(\"react-dnd\");\n\nvar _reactDndHtml5Backend = require(\"react-dnd-html5-backend\");\n\nvar _Flex = require(\"@strapi/design-system/Flex\");\n\nvar _Drag = _interopRequireDefault(require(\"@strapi/icons/Drag\"));\n\nvar _utils = require(\"../../../utils\");\n\nvar _FieldButtonContent = _interopRequireDefault(require(\"./FieldButtonContent\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nvar CustomDragIcon = /*#__PURE__*/(0, _styledComponents[\"default\"])(_Drag[\"default\"]).withConfig({\n  displayName: \"RelationalFieldButton__CustomDragIcon\",\n  componentId: \"sc-1fz9b02-0\"\n})([\"height:\", \"rem;width:\", \"rem;path{fill:\", \";}\"], 12 / 16, 12 / 16, function (_ref) {\n  var theme = _ref.theme;\n  return theme.colors.neutral600;\n});\nvar CustomFlex = /*#__PURE__*/(0, _styledComponents[\"default\"])(_Flex.Flex).withConfig({\n  displayName: \"RelationalFieldButton__CustomFlex\",\n  componentId: \"sc-1fz9b02-1\"\n})([\"opacity:\", \";\"], function (_ref2) {\n  var isDragging = _ref2.isDragging;\n  return isDragging ? 0 : 1;\n});\nvar DragButton = /*#__PURE__*/(0, _styledComponents[\"default\"])(_Flex.Flex).withConfig({\n  displayName: \"RelationalFieldButton__DragButton\",\n  componentId: \"sc-1fz9b02-2\"\n})([\"cursor:all-scroll;border-right:1px solid \", \";\"], function (_ref3) {\n  var theme = _ref3.theme;\n  return theme.colors.neutral200;\n});\n\nvar RelationalFieldButton = function RelationalFieldButton(_ref4) {\n  var attribute = _ref4.attribute,\n      onEditField = _ref4.onEditField,\n      onDeleteField = _ref4.onDeleteField,\n      children = _ref4.children,\n      index = _ref4.index,\n      name = _ref4.name,\n      onMoveField = _ref4.onMoveField;\n  var dragButtonRef = (0, _react.useRef)();\n\n  var _useDrop = (0, _reactDnd.useDrop)({\n    accept: _utils.ItemTypes.EDIT_RELATION,\n    hover: function hover(item) {\n      if (!dragButtonRef.current) {\n        return;\n      }\n\n      var dragIndex = item.index;\n      var hoverIndex = index; // Don't replace items with themselves\n\n      // Don't replace items with themselves\n      if (dragIndex === hoverIndex) {\n        return;\n      }\n\n      onMoveField(dragIndex, hoverIndex);\n      item.index = hoverIndex;\n    }\n  }),\n      _useDrop2 = (0, _slicedToArray2[\"default\"])(_useDrop, 2),\n      drop = _useDrop2[1];\n\n  var _useDrag = (0, _reactDnd.useDrag)({\n    type: _utils.ItemTypes.EDIT_RELATION,\n    item: function item() {\n      return {\n        index: index,\n        labelField: children,\n        name: name\n      };\n    },\n    collect: function collect(monitor) {\n      return {\n        isDragging: monitor.isDragging()\n      };\n    }\n  }),\n      _useDrag2 = (0, _slicedToArray2[\"default\"])(_useDrag, 3),\n      isDragging = _useDrag2[0].isDragging,\n      drag = _useDrag2[1],\n      dragPreview = _useDrag2[2];\n\n  (0, _react.useEffect)(function () {\n    dragPreview((0, _reactDndHtml5Backend.getEmptyImage)(), {\n      captureDraggingState: true\n    });\n  }, [dragPreview]);\n  drag(drop(dragButtonRef));\n\n  var getHeight = function getHeight() {\n    var higherFields = ['json', 'text', 'file', 'media', 'component', 'richtext', 'dynamiczone'];\n\n    if (attribute && higherFields.includes(attribute.type)) {\n      return \"\".concat(74 / 16, \"rem\");\n    }\n\n    return \"\".concat(32 / 16, \"rem\");\n  };\n\n  return /*#__PURE__*/_react[\"default\"].createElement(CustomFlex, {\n    width: \"100%\",\n    borderColor: \"neutral150\",\n    hasRadius: true,\n    background: \"neutral100\",\n    minHeight: getHeight(),\n    alignItems: \"stretch\",\n    isDragging: isDragging\n  }, /*#__PURE__*/_react[\"default\"].createElement(DragButton, {\n    as: \"span\",\n    type: \"button\",\n    ref: dragButtonRef,\n    onClick: function onClick(e) {\n      return e.stopPropagation();\n    },\n    alignItems: \"center\",\n    paddingLeft: 3,\n    paddingRight: 3 // Disable the keyboard navigation since the drag n drop isn't accessible with the keyboard for the moment\n    ,\n    tabIndex: -1\n  }, /*#__PURE__*/_react[\"default\"].createElement(CustomDragIcon, null)), /*#__PURE__*/_react[\"default\"].createElement(_FieldButtonContent[\"default\"], {\n    attribute: attribute,\n    onEditField: onEditField,\n    onDeleteField: onDeleteField\n  }, children));\n};\n\nRelationalFieldButton.defaultProps = {\n  attribute: undefined\n};\nRelationalFieldButton.propTypes = {\n  attribute: _propTypes[\"default\"].shape({\n    components: _propTypes[\"default\"].array,\n    component: _propTypes[\"default\"].string,\n    type: _propTypes[\"default\"].string\n  }),\n  onEditField: _propTypes[\"default\"].func.isRequired,\n  onDeleteField: _propTypes[\"default\"].func.isRequired,\n  children: _propTypes[\"default\"].string.isRequired,\n  index: _propTypes[\"default\"].number.isRequired,\n  name: _propTypes[\"default\"].string.isRequired,\n  onMoveField: _propTypes[\"default\"].func.isRequired\n};\nvar _default = RelationalFieldButton;\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}