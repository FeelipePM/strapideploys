{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _reactVirtualized = require(\"react-virtualized\");\n\nvar _Searchbar = require(\"@strapi/design-system/Searchbar\");\n\nvar _IconButton = require(\"@strapi/design-system/IconButton\");\n\nvar _Search = _interopRequireDefault(require(\"@strapi/icons/Search\"));\n\nvar _reactFontawesome = require(\"@fortawesome/react-fontawesome\");\n\nvar _Box = require(\"@strapi/design-system/Box\");\n\nvar _Flex = require(\"@strapi/design-system/Flex\");\n\nvar _Stack = require(\"@strapi/design-system/Stack\");\n\nvar _Typography = require(\"@strapi/design-system/Typography\");\n\nvar _useDataManager2 = _interopRequireDefault(require(\"../../hooks/useDataManager\"));\n\nvar _getTrad = _interopRequireDefault(require(\"../../utils/getTrad\"));\n\nvar _Cell = _interopRequireDefault(require(\"./Cell\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2[\"default\"])(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nvar CELL_WIDTH = 44;\n\nvar ComponentIconPicker = function ComponentIconPicker(_ref) {\n  var error = _ref.error,\n      isCreating = _ref.isCreating,\n      intlLabel = _ref.intlLabel,\n      name = _ref.name,\n      onChange = _ref.onChange,\n      value = _ref.value;\n\n  var _useDataManager = (0, _useDataManager2[\"default\"])(),\n      allIcons = _useDataManager.allIcons,\n      allComponentsIconAlreadyTaken = _useDataManager.allComponentsIconAlreadyTaken;\n\n  var _useIntl = (0, _reactIntl.useIntl)(),\n      formatMessage = _useIntl.formatMessage;\n\n  var _useState = (0, _react.useState)(value),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 1),\n      originalIcon = _useState2[0];\n\n  var initialIcons = allIcons.filter(function (ico) {\n    if (isCreating) {\n      return !allComponentsIconAlreadyTaken.includes(ico);\n    } // Edition\n\n\n    return !allComponentsIconAlreadyTaken.filter(function (icon) {\n      return icon !== originalIcon;\n    }).includes(ico);\n  });\n  var searchWrapperRef = (0, _react.useRef)();\n\n  var _useState3 = (0, _react.useState)(false),\n      _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n      showSearch = _useState4[0],\n      setShowSearch = _useState4[1];\n\n  var _useState5 = (0, _react.useState)(''),\n      _useState6 = (0, _slicedToArray2[\"default\"])(_useState5, 2),\n      search = _useState6[0],\n      setSearch = _useState6[1];\n\n  var _useState7 = (0, _react.useState)(initialIcons),\n      _useState8 = (0, _slicedToArray2[\"default\"])(_useState7, 2),\n      icons = _useState8[0],\n      setIcons = _useState8[1];\n\n  var toggleSearch = function toggleSearch() {\n    return setShowSearch(function (prev) {\n      return !prev;\n    });\n  };\n\n  (0, _react.useEffect)(function () {\n    if (showSearch) {\n      searchWrapperRef.current.querySelector('input').focus();\n    }\n  }, [showSearch]);\n\n  var handleChangeSearch = function handleChangeSearch(_ref2) {\n    var value = _ref2.target.value;\n    setSearch(value);\n    setIcons(function () {\n      return initialIcons.filter(function (icon) {\n        return icon.includes(value);\n      });\n    });\n  };\n\n  var errorMessage = error ? formatMessage({\n    id: error,\n    defaultMessage: error\n  }) : '';\n\n  var cellSizeAndPositionGetter = function cellSizeAndPositionGetter(_ref3) {\n    var index = _ref3.index;\n    var columnCount = 16;\n    var columnPosition = index % (columnCount || 1);\n    var height = CELL_WIDTH;\n    var width = CELL_WIDTH;\n    var x = columnPosition * (width + 1);\n    var y = parseInt(index / 16, 10) * CELL_WIDTH;\n    return {\n      height: height,\n      width: width,\n      x: x,\n      y: y\n    };\n  };\n\n  var cellCount = icons.length;\n  return /*#__PURE__*/_react[\"default\"].createElement(_Box.Box, null, /*#__PURE__*/_react[\"default\"].createElement(_Stack.Stack, {\n    spacing: 1\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Flex.Flex, {\n    justifyContent: \"space-between\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Typography.Typography, {\n    variant: \"pi\",\n    fontWeight: \"bold\",\n    textColor: \"neutral800\",\n    htmlFor: name,\n    as: \"label\"\n  }, formatMessage(intlLabel)), showSearch ? /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    ref: searchWrapperRef,\n    style: {\n      width: 206\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Searchbar.Searchbar, {\n    name: \"searchbar\",\n    onBlur: function onBlur() {\n      if (!search) {\n        toggleSearch();\n      }\n    },\n    onClear: function onClear() {\n      setSearch('');\n      setIcons(initialIcons);\n      toggleSearch();\n    },\n    value: search,\n    onChange: handleChangeSearch,\n    clearLabel: \"Clearing the icon search\",\n    placeholder: formatMessage({\n      id: (0, _getTrad[\"default\"])('ComponentIconPicker.search.placeholder'),\n      defaultMessage: 'Search for an icon'\n    }),\n    size: \"S\"\n  }, formatMessage({\n    id: (0, _getTrad[\"default\"])('ComponentIconPicker.search.placeholder'),\n    defaultMessage: 'Search for an icon'\n  }))) : /*#__PURE__*/_react[\"default\"].createElement(_IconButton.IconButton, {\n    onClick: toggleSearch,\n    \"aria-label\": \"Edit\",\n    icon: /*#__PURE__*/_react[\"default\"].createElement(_Search[\"default\"], null),\n    noBorder: true\n  })), /*#__PURE__*/_react[\"default\"].createElement(_Stack.Stack, {\n    spacing: 1\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Box.Box, {\n    background: \"neutral100\",\n    borderColor: error ? 'danger600' : '',\n    hasRadius: true\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Box.Box, null, /*#__PURE__*/_react[\"default\"].createElement(_reactVirtualized.AutoSizer, {\n    disableHeight: true\n  }, function (_ref4) {\n    var width = _ref4.width;\n    return /*#__PURE__*/_react[\"default\"].createElement(_reactVirtualized.Collection, {\n      cellCount: cellCount,\n      cellRenderer: function cellRenderer(_ref5) {\n        var index = _ref5.index,\n            key = _ref5.key,\n            style = _ref5.style;\n        var icon = icons[index];\n        var isSelected = icon === value;\n\n        var handleClick = function handleClick() {\n          onChange({\n            target: {\n              name: name,\n              value: icon\n            }\n          });\n        };\n\n        return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n          style: _objectSpread(_objectSpread({}, style), {}, {\n            width: CELL_WIDTH\n          }),\n          key: key\n        }, /*#__PURE__*/_react[\"default\"].createElement(_Cell[\"default\"], {\n          style: {\n            width: '100%',\n            height: CELL_WIDTH\n          },\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          onClick: handleClick,\n          isSelected: isSelected,\n          as: \"button\",\n          type: \"button\"\n        }, /*#__PURE__*/_react[\"default\"].createElement(_reactFontawesome.FontAwesomeIcon, {\n          icon: icon\n        })));\n      },\n      cellSizeAndPositionGetter: cellSizeAndPositionGetter,\n      height: 132,\n      width: width\n    });\n  }))), error && /*#__PURE__*/_react[\"default\"].createElement(_Typography.Typography, {\n    variant: \"pi\",\n    id: \"\".concat(name, \"-error\"),\n    textColor: \"danger600\",\n    \"data-strapi-field-error\": true\n  }, errorMessage))));\n};\n\nComponentIconPicker.defaultProps = {\n  error: null\n};\nComponentIconPicker.propTypes = {\n  error: _propTypes[\"default\"].string,\n  isCreating: _propTypes[\"default\"].bool.isRequired,\n  intlLabel: _propTypes[\"default\"].shape({\n    id: _propTypes[\"default\"].string.isRequired,\n    defaultMessage: _propTypes[\"default\"].string.isRequired,\n    values: _propTypes[\"default\"].object\n  }).isRequired,\n  name: _propTypes[\"default\"].string.isRequired,\n  onChange: _propTypes[\"default\"].func.isRequired,\n  value: _propTypes[\"default\"].string.isRequired\n};\nvar _default = ComponentIconPicker;\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}