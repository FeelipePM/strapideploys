{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.VideoPreview = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _objectWithoutProperties2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _Box = require(\"@strapi/design-system/Box\");\n\nvar _VisuallyHidden = require(\"@strapi/design-system/VisuallyHidden\");\n\nvar _excluded = [\"url\", \"mime\", \"onLoadDuration\", \"alt\"];\n// According to MDN\n// https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/readyState#value\nvar HAVE_FUTURE_DATA = 3;\n\nvar VideoPreview = function VideoPreview(_ref) {\n  var url = _ref.url,\n      mime = _ref.mime,\n      onLoadDuration = _ref.onLoadDuration,\n      alt = _ref.alt,\n      props = (0, _objectWithoutProperties2[\"default\"])(_ref, _excluded);\n\n  var handleTimeUpdate = function handleTimeUpdate(e) {\n    if (e.target.currentTime > 0) {\n      var video = e.target;\n      var canvas = document.createElement('canvas');\n      canvas.height = video.videoHeight;\n      canvas.width = video.videoWidth;\n      canvas.getContext('2d').drawImage(video, 0, 0, video.videoWidth, video.videoHeight);\n      video.replaceWith(canvas);\n      onLoadDuration(video.duration);\n    }\n  };\n\n  var handleThumbnailVisibility = function handleThumbnailVisibility(e) {\n    var video = e.target;\n    if (video.readyState < HAVE_FUTURE_DATA) return;\n    video.play();\n  };\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_Box.Box, (0, _extends2[\"default\"])({\n    as: \"figure\"\n  }, props, {\n    key: url\n  }), /*#__PURE__*/_react[\"default\"].createElement(\"video\", {\n    muted: true,\n    onLoadedData: handleThumbnailVisibility,\n    src: url,\n    crossOrigin: \"anonymous\",\n    onTimeUpdate: handleTimeUpdate\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"source\", {\n    type: mime\n  })), /*#__PURE__*/_react[\"default\"].createElement(_VisuallyHidden.VisuallyHidden, {\n    as: \"figcaption\"\n  }, alt));\n};\n\nexports.VideoPreview = VideoPreview;\nVideoPreview.defaultProps = {\n  onLoadDuration: function onLoadDuration() {},\n  size: 'M'\n};\nVideoPreview.propTypes = {\n  alt: _propTypes[\"default\"].string.isRequired,\n  url: _propTypes[\"default\"].string.isRequired,\n  mime: _propTypes[\"default\"].string.isRequired,\n  onLoadDuration: _propTypes[\"default\"].func,\n  size: _propTypes[\"default\"].oneOf(['S', 'M'])\n};","map":null,"metadata":{},"sourceType":"script"}