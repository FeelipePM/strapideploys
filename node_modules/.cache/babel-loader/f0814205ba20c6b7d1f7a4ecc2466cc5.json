{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MediaLibrary = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\n\nvar _helperPlugin = require(\"@strapi/helper-plugin\");\n\nvar _Layout = require(\"@strapi/design-system/Layout\");\n\nvar _Main = require(\"@strapi/design-system/Main\");\n\nvar _Button = require(\"@strapi/design-system/Button\");\n\nvar _Plus = _interopRequireDefault(require(\"@strapi/icons/Plus\"));\n\nvar _Box = require(\"@strapi/design-system/Box\");\n\nvar _BaseCheckbox = require(\"@strapi/design-system/BaseCheckbox\");\n\nvar _UploadAssetDialog = require(\"../../components/UploadAssetDialog/UploadAssetDialog\");\n\nvar _EditAssetDialog = require(\"../../components/EditAssetDialog\");\n\nvar _AssetList = require(\"../../components/AssetList\");\n\nvar _SortPicker = _interopRequireDefault(require(\"../../components/SortPicker\"));\n\nvar _useAssets2 = require(\"../../hooks/useAssets\");\n\nvar _utils = require(\"../../utils\");\n\nvar _Filters = require(\"./components/Filters\");\n\nvar _PaginationFooter = require(\"../../components/PaginationFooter\");\n\nvar _useMediaLibraryPermissions = require(\"../../hooks/useMediaLibraryPermissions\");\n\nvar _BulkDeleteButton = require(\"./components/BulkDeleteButton\");\n\nvar _EmptyAssets = require(\"../../components/EmptyAssets\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n// useState\nvar BoxWithHeight = /*#__PURE__*/(0, _styledComponents[\"default\"])(_Box.Box).withConfig({\n  displayName: \"MediaLibrary__BoxWithHeight\",\n  componentId: \"sc-1gb6n0n-0\"\n})([\"height:\", \"rem;display:flex;align-items:center;\"], 32 / 16);\n\nvar MediaLibrary = function MediaLibrary() {\n  var _data$pagination;\n\n  var _useMediaLibraryPermi = (0, _useMediaLibraryPermissions.useMediaLibraryPermissions)(),\n      canRead = _useMediaLibraryPermi.canRead,\n      canCreate = _useMediaLibraryPermi.canCreate,\n      canUpdate = _useMediaLibraryPermi.canUpdate,\n      canCopyLink = _useMediaLibraryPermi.canCopyLink,\n      canDownload = _useMediaLibraryPermi.canDownload,\n      isLoadingPermissions = _useMediaLibraryPermi.isLoading;\n\n  var _useQueryParams = (0, _helperPlugin.useQueryParams)(),\n      _useQueryParams2 = (0, _slicedToArray2[\"default\"])(_useQueryParams, 2),\n      query = _useQueryParams2[0].query,\n      setQuery = _useQueryParams2[1];\n\n  var _useIntl = (0, _reactIntl.useIntl)(),\n      formatMessage = _useIntl.formatMessage;\n\n  var _useAssets = (0, _useAssets2.useAssets)({\n    skipWhen: !canRead\n  }),\n      data = _useAssets.data,\n      isLoading = _useAssets.isLoading,\n      error = _useAssets.error;\n\n  var handleChangeSort = function handleChangeSort(value) {\n    setQuery({\n      sort: value\n    });\n  };\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      showUploadAssetDialog = _useState2[0],\n      setShowUploadAssetDialog = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(undefined),\n      _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n      assetToEdit = _useState4[0],\n      setAssetToEdit = _useState4[1];\n\n  var _useSelectionState = (0, _helperPlugin.useSelectionState)('id', []),\n      _useSelectionState2 = (0, _slicedToArray2[\"default\"])(_useSelectionState, 2),\n      selected = _useSelectionState2[0],\n      _useSelectionState2$ = _useSelectionState2[1],\n      selectOne = _useSelectionState2$.selectOne,\n      selectAll = _useSelectionState2$.selectAll;\n\n  var toggleUploadAssetDialog = function toggleUploadAssetDialog() {\n    return setShowUploadAssetDialog(function (prev) {\n      return !prev;\n    });\n  };\n\n  (0, _helperPlugin.useFocusWhenNavigate)();\n  var loading = isLoadingPermissions || isLoading;\n  var assets = data === null || data === void 0 ? void 0 : data.results;\n  var assetCount = (data === null || data === void 0 ? void 0 : (_data$pagination = data.pagination) === null || _data$pagination === void 0 ? void 0 : _data$pagination.total) || 0;\n  var isFiltering = Boolean(query._q || query.filters);\n  return /*#__PURE__*/_react[\"default\"].createElement(_Layout.Layout, null, /*#__PURE__*/_react[\"default\"].createElement(_Main.Main, {\n    \"aria-busy\": loading\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Layout.HeaderLayout, {\n    title: formatMessage({\n      id: (0, _utils.getTrad)('plugin.name'),\n      defaultMessage: 'Media Library'\n    }),\n    subtitle: formatMessage({\n      id: (0, _utils.getTrad)(assetCount > 0 ? 'header.content.assets-multiple' : 'header.content.assets.assets-single'),\n      defaultMessage: '0 assets'\n    }, {\n      number: assetCount\n    }),\n    primaryAction: canCreate ? /*#__PURE__*/_react[\"default\"].createElement(_Button.Button, {\n      startIcon: /*#__PURE__*/_react[\"default\"].createElement(_Plus[\"default\"], null),\n      onClick: toggleUploadAssetDialog\n    }, formatMessage({\n      id: (0, _utils.getTrad)('header.actions.add-assets'),\n      defaultMessage: 'Add new assets'\n    })) : undefined\n  }), /*#__PURE__*/_react[\"default\"].createElement(_Layout.ActionLayout, {\n    startActions: /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, canUpdate && /*#__PURE__*/_react[\"default\"].createElement(BoxWithHeight, {\n      paddingLeft: 2,\n      paddingRight: 2,\n      background: \"neutral0\",\n      hasRadius: true,\n      borderColor: \"neutral200\"\n    }, /*#__PURE__*/_react[\"default\"].createElement(_BaseCheckbox.BaseCheckbox, {\n      \"aria-label\": formatMessage({\n        id: (0, _utils.getTrad)('bulk.select.label'),\n        defaultMessage: 'Select all assets'\n      }),\n      indeterminate: (assets === null || assets === void 0 ? void 0 : assets.length) > 0 && selected.length > 0 && selected.length !== (assets === null || assets === void 0 ? void 0 : assets.length),\n      value: (assets === null || assets === void 0 ? void 0 : assets.length) > 0 && selected.length === (assets === null || assets === void 0 ? void 0 : assets.length),\n      onChange: function onChange() {\n        return selectAll(assets);\n      }\n    })), canRead && /*#__PURE__*/_react[\"default\"].createElement(_SortPicker[\"default\"], {\n      onChangeSort: handleChangeSort\n    }), canRead && /*#__PURE__*/_react[\"default\"].createElement(_Filters.Filters, null)),\n    endActions: /*#__PURE__*/_react[\"default\"].createElement(_helperPlugin.SearchURLQuery, {\n      label: formatMessage({\n        id: (0, _utils.getTrad)('search.label'),\n        defaultMessage: 'Search for an asset'\n      })\n    })\n  }), /*#__PURE__*/_react[\"default\"].createElement(_Layout.ContentLayout, null, selected.length > 0 && /*#__PURE__*/_react[\"default\"].createElement(_BulkDeleteButton.BulkDeleteButton, {\n    selectedAssets: selected,\n    onSuccess: selectAll\n  }), loading && /*#__PURE__*/_react[\"default\"].createElement(_helperPlugin.LoadingIndicatorPage, null), error && /*#__PURE__*/_react[\"default\"].createElement(_helperPlugin.AnErrorOccurred, null), !canRead && /*#__PURE__*/_react[\"default\"].createElement(_helperPlugin.NoPermissions, null), canRead && assets && assets.length === 0 && /*#__PURE__*/_react[\"default\"].createElement(_EmptyAssets.EmptyAssets, {\n    action: canCreate && !isFiltering ? /*#__PURE__*/_react[\"default\"].createElement(_Button.Button, {\n      variant: \"secondary\",\n      startIcon: /*#__PURE__*/_react[\"default\"].createElement(_Plus[\"default\"], null),\n      onClick: toggleUploadAssetDialog\n    }, formatMessage({\n      id: (0, _utils.getTrad)('header.actions.add-assets'),\n      defaultMessage: 'Add new assets'\n    })) : undefined,\n    content: // eslint-disable-next-line no-nested-ternary\n    isFiltering ? formatMessage({\n      id: (0, _utils.getTrad)('list.assets-empty.title-withSearch'),\n      defaultMessage: 'There are no assets with the applied filters'\n    }) : canCreate ? formatMessage({\n      id: (0, _utils.getTrad)('list.assets.empty'),\n      defaultMessage: 'Upload your first assets...'\n    }) : formatMessage({\n      id: (0, _utils.getTrad)('list.assets.empty.no-permissions'),\n      defaultMessage: 'The asset list is empty'\n    })\n  }), canRead && assets && assets.length > 0 && /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_AssetList.AssetList, {\n    assets: assets,\n    onEditAsset: setAssetToEdit,\n    onSelectAsset: selectOne,\n    selectedAssets: selected\n  }), (data === null || data === void 0 ? void 0 : data.pagination) && /*#__PURE__*/_react[\"default\"].createElement(_PaginationFooter.PaginationFooter, {\n    pagination: data.pagination\n  })))), showUploadAssetDialog && /*#__PURE__*/_react[\"default\"].createElement(_UploadAssetDialog.UploadAssetDialog, {\n    onClose: toggleUploadAssetDialog,\n    trackedLocation: \"upload\"\n  }), assetToEdit && /*#__PURE__*/_react[\"default\"].createElement(_EditAssetDialog.EditAssetDialog, {\n    onClose: function onClose() {\n      return setAssetToEdit(undefined);\n    },\n    asset: assetToEdit,\n    canUpdate: canUpdate,\n    canCopyLink: canCopyLink,\n    canDownload: canDownload,\n    trackedLocation: \"upload\"\n  }));\n};\n\nexports.MediaLibrary = MediaLibrary;","map":null,"metadata":{},"sourceType":"script"}