{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _get = _interopRequireDefault(require(\"lodash/get\"));\n\nvar _helperPlugin = require(\"@strapi/helper-plugin\");\n\nvar NOT_ALLOWED_FILTERS = ['json', 'component', 'media', 'richtext', 'dynamiczone', 'password'];\nvar TIMESTAMPS = ['createdAt', 'updatedAt'];\n\nvar useAllowedAttributes = function useAllowedAttributes(contentType, slug) {\n  var _useRBACProvider = (0, _helperPlugin.useRBACProvider)(),\n      allPermissions = _useRBACProvider.allPermissions;\n\n  var readPermissionsForSlug = (0, _helperPlugin.findMatchingPermissions)(allPermissions, [{\n    action: 'plugin::content-manager.explorer.read',\n    subject: slug\n  }]);\n  var readPermissionForAttr = (0, _get[\"default\"])(readPermissionsForSlug, ['0', 'properties', 'fields'], []);\n  var attributesArray = Object.keys((0, _get[\"default\"])(contentType, ['attributes']), {});\n  var allowedAttributes = attributesArray.filter(function (attr) {\n    var current = (0, _get[\"default\"])(contentType, ['attributes', attr], {});\n\n    if (!current.type) {\n      return false;\n    }\n\n    if (NOT_ALLOWED_FILTERS.includes(current.type)) {\n      return false;\n    }\n\n    if (!readPermissionForAttr.includes(attr) && attr !== 'id' && !TIMESTAMPS.includes(attr)) {\n      return false;\n    }\n\n    return true;\n  }).sort();\n  return allowedAttributes;\n};\n\nvar _default = useAllowedAttributes;\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}