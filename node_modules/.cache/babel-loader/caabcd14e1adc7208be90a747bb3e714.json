{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _helperPlugin = require(\"@strapi/helper-plugin\");\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _isEmpty = _interopRequireDefault(require(\"lodash/isEmpty\"));\n\nvar _exposedHooks = require(\"../../../exposedHooks\");\n\nvar _selectors = require(\"../../pages/ListView/selectors\");\n\nvar _utils = require(\"../../utils\");\n\nvar _State = _interopRequireDefault(require(\"../State\"));\n\nvar _TableRows = _interopRequireDefault(require(\"./TableRows\"));\n\nvar _ConfirmDialogDeleteAll = _interopRequireDefault(require(\"./ConfirmDialogDeleteAll\"));\n\nvar _ConfirmDialogDelete = _interopRequireDefault(require(\"./ConfirmDialogDelete\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2[\"default\"])(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nvar DynamicTable = function DynamicTable(_ref) {\n  var canCreate = _ref.canCreate,\n      canDelete = _ref.canDelete,\n      contentTypeName = _ref.contentTypeName,\n      action = _ref.action,\n      isBulkable = _ref.isBulkable,\n      isLoading = _ref.isLoading,\n      onConfirmDelete = _ref.onConfirmDelete,\n      onConfirmDeleteAll = _ref.onConfirmDeleteAll,\n      layout = _ref.layout,\n      rows = _ref.rows;\n\n  var _useStrapiApp = (0, _helperPlugin.useStrapiApp)(),\n      runHookWaterfall = _useStrapiApp.runHookWaterfall;\n\n  var hasDraftAndPublish = layout.contentType.options.draftAndPublish || false;\n\n  var _useIntl = (0, _reactIntl.useIntl)(),\n      formatMessage = _useIntl.formatMessage;\n\n  var displayedHeaders = (0, _reactRedux.useSelector)(_selectors.selectDisplayedHeaders);\n  var tableHeaders = (0, _react.useMemo)(function () {\n    var headers = runHookWaterfall(_exposedHooks.INJECT_COLUMN_IN_TABLE, {\n      displayedHeaders: displayedHeaders,\n      layout: layout\n    });\n    var formattedHeaders = headers.displayedHeaders.map(function (header) {\n      if (header.fieldSchema.type === 'relation') {\n        var sortFieldValue = \"\".concat(header.name, \".\").concat(header.metadatas.mainField.name);\n        return _objectSpread(_objectSpread({}, header), {}, {\n          name: sortFieldValue\n        });\n      }\n\n      return header;\n    });\n\n    if (!hasDraftAndPublish) {\n      return formattedHeaders;\n    }\n\n    return [].concat((0, _toConsumableArray2[\"default\"])(formattedHeaders), [{\n      key: '__published_at_temp_key__',\n      name: 'publishedAt',\n      fieldSchema: {\n        type: 'custom'\n      },\n      metadatas: {\n        label: formatMessage({\n          id: (0, _utils.getTrad)('containers.ListPage.table-headers.published_at')\n        }),\n        searchable: false,\n        sortable: true\n      },\n      cellFormatter: function cellFormatter(cellData) {\n        var isPublished = !(0, _isEmpty[\"default\"])(cellData.publishedAt);\n        return /*#__PURE__*/_react[\"default\"].createElement(_State[\"default\"], {\n          isPublished: isPublished\n        });\n      }\n    }]);\n  }, [runHookWaterfall, displayedHeaders, layout, hasDraftAndPublish, formatMessage]);\n  return /*#__PURE__*/_react[\"default\"].createElement(_helperPlugin.DynamicTable, {\n    components: {\n      ConfirmDialogDelete: _ConfirmDialogDelete[\"default\"],\n      ConfirmDialogDeleteAll: _ConfirmDialogDeleteAll[\"default\"]\n    },\n    contentType: contentTypeName,\n    action: action,\n    isLoading: isLoading,\n    headers: tableHeaders,\n    onConfirmDelete: onConfirmDelete,\n    onConfirmDeleteAll: onConfirmDeleteAll,\n    onOpenDeleteAllModalTrackedEvent: \"willBulkDeleteEntries\",\n    rows: rows,\n    withBulkActions: true,\n    withMainAction: canDelete && isBulkable\n  }, /*#__PURE__*/_react[\"default\"].createElement(_TableRows[\"default\"], {\n    canCreate: canCreate,\n    canDelete: canDelete,\n    headers: tableHeaders,\n    rows: rows,\n    withBulkActions: true,\n    withMainAction: canDelete && isBulkable\n  }));\n};\n\nDynamicTable.defaultProps = {\n  action: undefined\n};\nDynamicTable.propTypes = {\n  canCreate: _propTypes[\"default\"].bool.isRequired,\n  canDelete: _propTypes[\"default\"].bool.isRequired,\n  contentTypeName: _propTypes[\"default\"].string.isRequired,\n  action: _propTypes[\"default\"].node,\n  isBulkable: _propTypes[\"default\"].bool.isRequired,\n  isLoading: _propTypes[\"default\"].bool.isRequired,\n  layout: _propTypes[\"default\"].exact({\n    components: _propTypes[\"default\"].object.isRequired,\n    contentType: _propTypes[\"default\"].shape({\n      attributes: _propTypes[\"default\"].object.isRequired,\n      metadatas: _propTypes[\"default\"].object.isRequired,\n      layouts: _propTypes[\"default\"].shape({\n        list: _propTypes[\"default\"].array.isRequired,\n        editRelations: _propTypes[\"default\"].array\n      }).isRequired,\n      options: _propTypes[\"default\"].object.isRequired,\n      settings: _propTypes[\"default\"].object.isRequired\n    }).isRequired\n  }).isRequired,\n  onConfirmDelete: _propTypes[\"default\"].func.isRequired,\n  onConfirmDeleteAll: _propTypes[\"default\"].func.isRequired,\n  rows: _propTypes[\"default\"].array.isRequired\n};\nvar _default = DynamicTable;\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}