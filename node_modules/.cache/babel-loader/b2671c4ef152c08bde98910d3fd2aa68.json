{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _Typography = require(\"@strapi/design-system/Typography\");\n\nvar _Box = require(\"@strapi/design-system/Box\");\n\nvar _Stack = require(\"@strapi/design-system/Stack\");\n\nvar _helperPlugin = require(\"@strapi/helper-plugin\");\n\nvar _Editor = _interopRequireDefault(require(\"./Editor\"));\n\nvar _WysiwygNav = _interopRequireDefault(require(\"./WysiwygNav\"));\n\nvar _WysiwygFooter = _interopRequireDefault(require(\"./WysiwygFooter\"));\n\nvar _Hint = _interopRequireDefault(require(\"../Hint\"));\n\nvar _utils = require(\"./utils/utils\");\n\nvar _EditorLayout = require(\"./EditorLayout\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2[\"default\"])(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nvar LabelAction = /*#__PURE__*/(0, _styledComponents[\"default\"])(_Box.Box).withConfig({\n  displayName: \"Wysiwyg__LabelAction\",\n  componentId: \"sc-c0p90q-0\"\n})([\"svg path{fill:\", \";}\"], function (_ref) {\n  var theme = _ref.theme;\n  return theme.colors.neutral500;\n});\nvar TypographyAsterisk = /*#__PURE__*/(0, _styledComponents[\"default\"])(_Typography.Typography).withConfig({\n  displayName: \"Wysiwyg__TypographyAsterisk\",\n  componentId: \"sc-c0p90q-1\"\n})([\"line-height:0;\"]);\n\nvar Wysiwyg = function Wysiwyg(_ref2) {\n  var description = _ref2.description,\n      disabled = _ref2.disabled,\n      error = _ref2.error,\n      intlLabel = _ref2.intlLabel,\n      labelAction = _ref2.labelAction,\n      name = _ref2.name,\n      onChange = _ref2.onChange,\n      placeholder = _ref2.placeholder,\n      value = _ref2.value,\n      required = _ref2.required;\n\n  var _useIntl = (0, _reactIntl.useIntl)(),\n      formatMessage = _useIntl.formatMessage;\n\n  var textareaRef = (0, _react.useRef)(null);\n  var editorRef = (0, _react.useRef)(null);\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      isPreviewMode = _useState2[0],\n      setIsPreviewMode = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(false),\n      _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n      mediaLibVisible = _useState4[0],\n      setMediaLibVisible = _useState4[1];\n\n  var _useState5 = (0, _react.useState)(false),\n      _useState6 = (0, _slicedToArray2[\"default\"])(_useState5, 2),\n      isExpandMode = _useState6[0],\n      setIsExpandMode = _useState6[1];\n\n  var _useLibrary = (0, _helperPlugin.useLibrary)(),\n      components = _useLibrary.components;\n\n  var MediaLibraryDialog = components['media-library'];\n\n  var handleToggleMediaLib = function handleToggleMediaLib() {\n    return setMediaLibVisible(function (prev) {\n      return !prev;\n    });\n  };\n\n  var handleTogglePreviewMode = function handleTogglePreviewMode() {\n    return setIsPreviewMode(function (prev) {\n      return !prev;\n    });\n  };\n\n  var handleToggleExpand = function handleToggleExpand() {\n    setIsPreviewMode(false);\n    setIsExpandMode(function (prev) {\n      return !prev;\n    });\n  };\n\n  var handleActionClick = function handleActionClick(value, currentEditorRef, togglePopover) {\n    switch (value) {\n      case 'Link':\n      case 'Strikethrough':\n        {\n          (0, _utils.markdownHandler)(currentEditorRef, value);\n          togglePopover();\n          break;\n        }\n\n      case 'Code':\n      case 'Quote':\n        {\n          (0, _utils.quoteAndCodeHandler)(currentEditorRef, value);\n          togglePopover();\n          break;\n        }\n\n      case 'Bold':\n      case 'Italic':\n      case 'Underline':\n        {\n          (0, _utils.markdownHandler)(currentEditorRef, value);\n          break;\n        }\n\n      case 'BulletList':\n      case 'NumberList':\n        {\n          (0, _utils.listHandler)(currentEditorRef, value);\n          togglePopover();\n          break;\n        }\n\n      case 'h1':\n      case 'h2':\n      case 'h3':\n      case 'h4':\n      case 'h5':\n      case 'h6':\n        {\n          (0, _utils.titleHandler)(currentEditorRef, value);\n          break;\n        }\n\n      default:\n        {// Nothing\n        }\n    }\n  };\n\n  var handleSelectAssets = function handleSelectAssets(files) {\n    var formattedFiles = files.map(function (f) {\n      return {\n        alt: f.alternativeText || f.name,\n        url: (0, _helperPlugin.prefixFileUrlWithBackendUrl)(f.url),\n        mime: f.mime\n      };\n    });\n    (0, _utils.insertFile)(editorRef, formattedFiles);\n    setMediaLibVisible(false);\n  };\n\n  var formattedPlaceholder = placeholder ? formatMessage({\n    id: placeholder.id,\n    defaultMessage: placeholder.defaultMessage\n  }, _objectSpread({}, placeholder.values)) : '';\n  var errorMessage = error ? formatMessage({\n    id: error,\n    defaultMessage: error\n  }) : '';\n  var label = intlLabel.id ? formatMessage({\n    id: intlLabel.id,\n    defaultMessage: intlLabel.defaultMessage\n  }, _objectSpread({}, intlLabel.values)) : name;\n  return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_Stack.Stack, {\n    spacing: 1\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Stack.Stack, {\n    horizontal: true,\n    spacing: 1\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Typography.Typography, {\n    variant: \"pi\",\n    fontWeight: \"bold\",\n    textColor: \"neutral800\"\n  }, label, required && /*#__PURE__*/_react[\"default\"].createElement(TypographyAsterisk, {\n    textColor: \"danger600\"\n  }, \"*\")), labelAction && /*#__PURE__*/_react[\"default\"].createElement(LabelAction, {\n    paddingLeft: 1\n  }, labelAction)), /*#__PURE__*/_react[\"default\"].createElement(_EditorLayout.EditorLayout, {\n    isExpandMode: isExpandMode,\n    error: error,\n    previewContent: value,\n    onCollapse: handleToggleExpand\n  }, /*#__PURE__*/_react[\"default\"].createElement(_WysiwygNav[\"default\"], {\n    isExpandMode: isExpandMode,\n    editorRef: editorRef,\n    isPreviewMode: isPreviewMode,\n    onActionClick: handleActionClick,\n    onToggleMediaLib: handleToggleMediaLib,\n    onTogglePreviewMode: isExpandMode ? undefined : handleTogglePreviewMode,\n    disabled: disabled\n  }), /*#__PURE__*/_react[\"default\"].createElement(_Editor[\"default\"], {\n    disabled: disabled,\n    isExpandMode: isExpandMode,\n    editorRef: editorRef,\n    error: errorMessage,\n    isPreviewMode: isPreviewMode,\n    name: name,\n    onChange: onChange,\n    placeholder: formattedPlaceholder,\n    textareaRef: textareaRef,\n    value: value\n  }), !isExpandMode && /*#__PURE__*/_react[\"default\"].createElement(_WysiwygFooter[\"default\"], {\n    onToggleExpand: handleToggleExpand\n  })), /*#__PURE__*/_react[\"default\"].createElement(_Hint[\"default\"], {\n    description: description,\n    name: name,\n    error: error\n  })), errorMessage && /*#__PURE__*/_react[\"default\"].createElement(_Box.Box, {\n    paddingTop: 1\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Typography.Typography, {\n    variant: \"pi\",\n    textColor: \"danger600\",\n    \"data-strapi-field-error\": true\n  }, errorMessage)), mediaLibVisible && /*#__PURE__*/_react[\"default\"].createElement(MediaLibraryDialog, {\n    onClose: handleToggleMediaLib,\n    onSelectAssets: handleSelectAssets\n  }));\n};\n\nWysiwyg.defaultProps = {\n  description: null,\n  disabled: false,\n  error: '',\n  labelAction: undefined,\n  placeholder: null,\n  required: false,\n  value: ''\n};\nWysiwyg.propTypes = {\n  description: _propTypes[\"default\"].shape({\n    id: _propTypes[\"default\"].string.isRequired,\n    defaultMessage: _propTypes[\"default\"].string.isRequired,\n    values: _propTypes[\"default\"].object\n  }),\n  disabled: _propTypes[\"default\"].bool,\n  error: _propTypes[\"default\"].string,\n  intlLabel: _propTypes[\"default\"].shape({\n    id: _propTypes[\"default\"].string.isRequired,\n    defaultMessage: _propTypes[\"default\"].string.isRequired,\n    values: _propTypes[\"default\"].object\n  }).isRequired,\n  labelAction: _propTypes[\"default\"].element,\n  name: _propTypes[\"default\"].string.isRequired,\n  onChange: _propTypes[\"default\"].func.isRequired,\n  placeholder: _propTypes[\"default\"].shape({\n    id: _propTypes[\"default\"].string.isRequired,\n    defaultMessage: _propTypes[\"default\"].string.isRequired,\n    values: _propTypes[\"default\"].object\n  }),\n  required: _propTypes[\"default\"].bool,\n  value: _propTypes[\"default\"].string\n};\nvar _default = Wysiwyg;\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}